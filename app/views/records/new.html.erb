<details class="usage-details">
  <summary>
    <h2>ã€ğŸŒ±ã‚¢ãƒ—ãƒªã®ä½¿ã„æ–¹ã€‘</h2>
  </summary>
  <div class="record-description">
    <%= image_tag "howtouse.png", alt: "ä½¿ã„æ–¹", class: "howtouse2" %>
  </div>
</details>

<div class="record-time">
  <% if current_user %>
    <% if current_user.first_record_date.present? %>
      <p>ç¾åœ¨è¨˜éŒ² <%= current_user.days_since_first_record %> æ—¥ç›®</p>
      <p>åˆè¨ˆ <%= current_user.total_record_duration_hours %> æ™‚é–“è¨˜éŒ²ã—ãŸã‚ˆğŸŒ±</p>
    <% else %>
      <p>ã¾ã è¨˜éŒ²ãŒãªã„ã¿ãŸã„ï¼æœ€åˆã®è¨˜éŒ²ã‚’å§‹ã‚ã‚ˆã†ğŸŒ±</p>
    <% end %>
  <% else %>
    <p>è¨˜éŒ²ã‚’ã¤ã‘ã¦ã€èŠ±ã‚’è‚²ã¦ã¦ã¿ã‚ˆã†ï¼</p>
  <p>
  <% end %>
</div>
<br>

<%# === ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒé–¢é€£ã®ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆæ™‚é–“è¨˜éŒ²ç”¨ï¼‰ã“ã“ã‹ã‚‰ === %>
<%= form_with model: @record, url: records_path, data: { turbo: false }, id: "time_record_form" do |f| %>
  <div id="timer-section" data-flower-id="<%= @user_flower.id %>">
    <div id="timer">00:00:00</div>
    <div class="timer-controls">
      <button type="button" id="start" class="btn-start">é–‹å§‹</button>
      <button type="button" id="stop" class="btn-stop">åœæ­¢</button>
      <button type="button" id="record_time_submit" class="btn-record">è¨˜éŒ²ã™ã‚‹</button>
    </div>

    <div id="seed-image" style="display: none;">
      <img src="<%= asset_path('Sprout.png') %>" alt="èŠ±ã®ç¨®" />
    </div>
  </div>

  <%= f.hidden_field :time, id: "record_time_field" %>
<% end %>
<%# === ã‚¹ãƒˆãƒƒãƒ—ã‚¦ã‚©ãƒƒãƒé–¢é€£ã®ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆæ™‚é–“è¨˜éŒ²ç”¨ï¼‰ã“ã“ã¾ã§ === %>

<div
  id="flower-message"
  data-flash-message="<%= j(flash[:notice] || flash[:alert]) %>"
  data-flash-image="<%= image_path(flash[:flower_image]) if flash[:flower_image].present? %>"
  data-flowerseeds-url="<%= image_url('Flowerseeds.png') %>"
  data-sprout-url="<%= image_url('Sprout.png') %>"
  data-bud-url="<%= image_url('Bud.png') %>"
  data-fullbloom1-url="<%= image_url('FullBloom1.png') %>"
  data-fullbloom2-url="<%= image_url('FullBloom2.png') %>"
  data-thanks-url="<%= image_url('Thanks.png') %>"
  class="message hidden">
</div>

<hr>

<h2>ToDoãƒªã‚¹ãƒˆ</h2>

<%# === ToDoã‚¿ã‚¹ã‚¯è¿½åŠ ç”¨ã®ãƒ•ã‚©ãƒ¼ãƒ  ã“ã“ã‹ã‚‰ === %>
<div class="todo-section">
  <%# ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ãŒã€ŒTODOã‚’è¿½åŠ ã€ã™ã‚‹å½¹å‰²ã‚’æ‹…ã†ã‚ˆã€‚ %>
  <%= form_with model: @record, url: records_path, data: { turbo_stream: true }, id: "new_record_form", class: "todo-form" do |f| %>
    <div id="record_errors">
      <% if @record.errors.any? %>
        <div class="error-messages">
          <h4><%= pluralize(@record.errors.count, "ã‚¨ãƒ©ãƒ¼") %>:</h4>
          <ul>
            <% @record.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </div>

    <div class="field form-group">
      <%= f.label :task_name, "æ–°ã—ã„ToDoã‚’è¿½åŠ ", class: "form-label" %><br />
      <%= f.text_field :task_name, data: { autofocus: true }, class: "form-input", placeholder: "ä¾‹: ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã€éƒ¨å±‹ã®æƒé™¤" %>
    </div>

    <%# ã“ã® submit ãƒœã‚¿ãƒ³ãŒã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã™ã‚‹ã‚ˆ %>
    <%= f.submit "ToDoã‚’è¿½åŠ ", class: "btn-add-todo" %>
  <% end %>

  <%# === ToDoãƒªã‚¹ãƒˆè¡¨ç¤ºéƒ¨åˆ† ã“ã“ã‹ã‚‰ === %>
  <div class="todo-list-container" id="todo-list">
    <h3>æœªå®Œäº†ã®ToDo</h3>
    <ul id="todo_items" class="todo-list">
      <%= render partial: 'record', collection: @records %>
    </ul>
  </div>
  <%# === ToDoãƒªã‚¹ãƒˆè¡¨ç¤ºéƒ¨åˆ† ã“ã“ã¾ã§ === %>
  <%= link_to "ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼/ã‚°ãƒ©ãƒ•ã¸", analytics_records_path, class: "btn-calendar" %>
</div>
